<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Foogra - Discover & Book the best restaurants at the best price">
    <meta name="author" content="Ansonika">
    <title>Foogra - Discover & Book the best restaurants at the best price</title>

    <!-- Favicons-->
    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" type="image/x-icon" href="/img/apple-touch-icon-57x57-precomposed.png">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="72x72" href="/img/apple-touch-icon-72x72-precomposed.png">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="114x114" href="/img/apple-touch-icon-114x114-precomposed.png">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="144x144" href="/img/apple-touch-icon-144x144-precomposed.png">

     <!-- GOOGLE WEB FONT -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- BASE CSS -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/style.css" rel="stylesheet">

    <!-- SPECIFIC CSS -->
    <link href="/css/submit.css" rel="stylesheet">

    <!-- YOUR CUSTOM CSS -->
    <link href="/css/custom.css" rel="stylesheet">

</head>

<body>


	<!-- /header -->

	

		<!-- ❗regist.html용 Spring 연동 폼❗ -->

		<!-- form 태그 시작 -->
		<form method="post" action="/store/regist" enctype="multipart/form-data" id="register" autocomplete="off">
			<div class="card mb-4">
				<h2 class="form_title">가게 등록</h2>
				<div class="card-body">

					<!-- ① 이미지 업로드 -->
					<div id="image-upload-area" style="border: 2px dashed #ccc; padding: 40px 30px 30px 30px; text-align: center; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center;">
						<p id="upload-text" style="margin-top: 12px;">Drop files here to upload</p>
						<input type="file" id="image-input" name="storeMainImage" accept="image/*" style="display: none;" />
						<img id="preview-image" src="" style="max-width: 100%; display: none; margin-top: 10px;" />
						<input type="hidden" name="approvalStatus" value="WAITING" />
						<input type="hidden" name="operationStatus" value="TEMP_CLOSED" />
					</div>

					<!-- ② 가게명 / ③ 도로명 주소 API / ④ 전화번호 -->
					<div class="row mb-3">
					<div class="row mb-3">
						<div class="col-md-6 position-relative">
							<!-- 가게명 -->
							<input type="text" name="storeName" class="form-control mb-3" placeholder="가게명" required />
							<!-- 전화번호 -->
							<!-- 전화번호 -->
							<div class="form-group mb-0">
								<label for="phonePrefix" style="font-weight: normal;">전화번호</label>
								<div class="d-flex gap-2">
									<!-- 앞자리 선택 -->
									<select id="phonePrefix" name="phonePrefix" class="form-select" style="max-width: 100px;" required>
										<option value="" disabled selected>선택</option>
										<option value="02">02</option>
										<option value="031">031</option>
										<option value="032">032</option>
										<option value="033">042</option>
										<option value="010">051</option>
										<option value="011">053</option>
										<option value="032">062</option>
										<option value="033">033</option>
										<option value="010">041</option>
										<option value="011">043</option>
										<option value="032">054</option>
										<option value="033">055</option>
										<option value="010">061</option>
										<option value="011">063</option>
										<option value="044">044</option>
										<!-- 필요한 번호 추가 -->
									</select>

									<!-- 나머지 번호 입력 -->
									<input type="text" id="phoneRest" name="phoneRest" class="form-control" placeholder="1234-5678" maxlength="9" required />
								</div>
								<!-- 합친 전화번호를 form submit 시 hidden 필드로 만들기 -->
								<input type="hidden" id="phone" name="phone" />
							</div>
						</div>

						<div class="col-md-6 position-relative">
							<!-- 주소 입력 영역 -->
							<div class="address-group">
								<!-- 도로명 주소 -->
								<input type="text" id="address-api" name="address" class="form-control" placeholder="도로명 주소" readonly />
								<!-- 우편번호 (hidden) -->
								<input type="hidden" id="zipcode" name="zipcode" />
								<!-- 상세주소 -->
								<input
										type="text"
										id="store_detail_input"
										name="store_detail_input"
										class="form-control mt-2"
										placeholder="상세 주소 입력"
										autocomplete="off"
										autocorrect="off"
										spellcheck="false"
										inputmode="text"
								/>

								<!-- 숨김 필드: 위도, 경도, 법정코드 -->
								<input type="hidden" id="storeLat" name="storeLat" />
								<input type="hidden" id="storeLng" name="storeLng" />
								<input type="hidden" id="storeLegalCode" name="storeLegalCode" />

								<!-- 주소 검색 버튼 -->
								<button type="button" class="btn mt-2" id="searchAddressBtn" style="background-color: #f39c12; color: white; border: none;">
									주소 검색
								</button>
							</div>
						</div>
					</div>

				<!-- ⑤ 요일별 영업시간 -->
						<div class="box_general padding_bottom">
							<div class="header_box version_2">
								<h2><i class="fa fa-clock-o"></i>Opening Hours</h2>
							</div>
							<div id="opening-schedule"></div>
						</div>

					<!-- ⑥ 지역카드, 유아 동반, 주차 : 라디오 · 체크박스 -->
					<div class="mb-4">

						<!-- 지역카드 사용 가능 -->
						<div class="form-check d-inline-block me-4" style="vertical-align: middle;">
							<input type="hidden" name="isLocalCard" value="false" />
							<input type="checkbox" id="regionCardCheck" name="isLocalCard" class="form-check-input" value="true" />
							<label for="regionCardCheck" class="form-check-label">지역카드 사용 가능</label>
						</div>

						<!-- 유아 동반 가능 -->
						<div class="form-check d-inline-block me-4" style="vertical-align: middle;">
							<input class="form-check-input" type="checkbox" name="isChildAllowed" value="true" id="childAllowed">
							<label class="form-check-label" for="childAllowed">유아 동반 가능</label>
						</div>

						<!-- 주차 -->
						<div class="mt-3">
							<label class="form-label me-3">주차</label>
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="hasParking" id="parkingFree" value="FREE">
								<label class="form-check-label" for="parkingFree">무료</label>
							</div>
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="hasParking" id="parkingPaid" value="PAID">
								<label class="form-check-label" for="parkingPaid">유료</label>
							</div>
							<div class="form-check form-check-inline">
								<input class="form-check-input" type="radio" name="hasParking" id="parkingNone" value="NOT_AVAILABLE">
								<label class="form-check-label" for="parkingNone">불가</label>
							</div>
						</div>

					</div>

					<!-- ⑦ 사장님 한 줄 소개 -->
					<div class="form-group mb-4" style="position: relative; width: 100%;">
						<label for="owner-intro" style="font-weight: bold; color: #2c3e50;">
							사장님 한 줄 소개
						</label>
						<textarea
								id="owner-intro"
								name="ownerComment"
								class="form-control"
								rows="8"
								placeholder="매장 소개를 적어주세요."
								style="white-space: pre-line; line-height: 1.5; height: 140px;"
						></textarea>
						<div id="owner-intro-hint" style="
								position: absolute;
								top: 48px;
								left: 16px;
								color: #888;
								font-size: 0.9em;
								pointer-events: none;
								white-space: pre-line;
								line-height: 1.3;
								user-select: none;
								opacity: 1;
								transition: opacity 0.3s;
							">
							• 주말/공휴일 영업 여부<br>• 유료 주차(ex: 1시간당 2,000원) 안내
						</div>

					</div>

					<hr>
					<h6 class="mb-3">메뉴 등록</h6>
					<div id="menu-items">
						<div class="menu-item row align-items-center mb-4">
							<!-- 이미지 업로드 -->
							<div class="col-md-4">
								<div class="menu-image-upload" style="border: 2px dashed #ccc; padding: 30px 20px; text-align: center; cursor: pointer; height: 180px;">
									<p style="margin-top: 10px;">Drop files here to upload</p>
									<input type="file" name="menus[0].menuImageFile" class="menu-image-input" accept="image/*" style="display: none;" />
									<img class="menu-preview-image" src="" style="max-width: 100%; max-height: 120px; display: none; margin-top: 10px;" />
								</div>
							</div>

							<!-- 메뉴 정보 -->
							<div class="col-md-8">
								<div class="row">
									<!-- 메뉴명 -->
									<div class="col-md-4">
										<input type="text" name="menus[0].menuName" class="form-control" placeholder="메뉴 이름" required />
									</div>

									<!-- 가격 -->
									<div class="col-md-6 mb-2">
										<div class="input-group">
											<input type="number" name="menus[0].price" class="form-control" placeholder="가격" min="0" step="500" required>
											<span class="input-group-text">원</span>
										</div>
									</div>

									<!-- 카테고리 선택 및 육수 선택 묶음 -->
									<div class="col-md-8 mb-2 d-flex gap-2">
										<!-- 카테고리 드롭다운 -->
										<select name="menus[0].ramenCategoryId" class="form-select form-select-sm scrollable-select" style="flex: 1;">
											<option disabled selected>카테고리 선택</option>
											<option value="돈코츠">돈코츠 (Tonkotsu, 돼지뼈 육수)</option>
											<option value="쇼유">쇼유 (Shoyu, 간장 베이스)</option>
											<option value="미소">미소 (Miso, 된장 베이스)</option>
											<option value="시오">시오 (Shio, 소금 베이스)</option>
											<option value="카레">카레 (Curry 라멘)</option>
											<option value="츠케멘">츠케멘 (찍먹 스타일)</option>
											<option value="탄탄멘">탄탄멘 (Spicy sesame)</option>
											<option value="사케라멘">사케라멘 (해산물 베이스)</option>
											<option value="마제소바">마제소바 (비빔면 스타일)</option>
										</select>

										<!-- 육수 선택 드롭다운 -->
										<select name="menus[0].ramenSoupId" class="form-select form-select-sm scrollable-select" style="flex: 1;">
											<option disabled selected>육수 선택</option>
											<option value="1">돈코츠 (돼지뼈)</option>
											<option value="2">소유 (간장)</option>
											<option value="3">미소 (된장)</option>
											<option value="4">시오 (소금)</option>
											<option value="4">토리파이탄 (닭육수)</option>
											<option value="4">가츠오부시 (가다랑어포)</option>
											<option value="4">콘부 (다시마)</option>
											<option value="4">해산물 베이스</option>
										</select>
									</div>

									<!-- 메뉴 설명 + 기본 토핑 -->
									<div class="col-md-12 mb-2 d-flex gap-3 align-items-start">
										<!-- 메뉴 설명 -->
										<div class="col-md-6 mt-2">
											<textarea name="menus[0].menuDescription" class="form-control" rows="2" placeholder="설명"></textarea>
										</div>

										<!-- 기본 토핑 선택 -->
										<div>
											<label class="form-label d-block">기본 토핑 선택</label>
											<div class="topping-tags" data-menu-index="0">
												<span class="topping-tag" data-id="1" data-name="차슈">차슈</span>
												<span class="topping-tag" data-id="2" data-name="닭가슴살">닭가슴살</span>
												<span class="topping-tag" data-id="3" data-name="반숙 계란">반숙 계란</span>
												<span class="topping-tag" data-id="4" data-name="파">파</span>
												<span class="topping-tag" data-id="5" data-name="김">김</span>
												<span class="topping-tag" data-id="6" data-name="멘마">멘마</span>
												<span class="topping-tag" data-id="7" data-name="숙주">숙주</span>
												<span class="topping-tag" data-id="8" data-name="버터">버터</span>
												<span class="topping-tag" data-id="9" data-name="옥수수">옥수수</span>
												<span class="topping-tag" data-id="10" data-name="김치">김치</span>
												<span class="topping-tag" data-id="11" data-name="생강">생강</span>
												<span class="topping-tag" data-id="12" data-name="마늘">마늘</span>
												<span class="topping-tag" data-id="13" data-name="치즈">치즈</span>
												<span class="topping-tag" data-id="14" data-name="매운 고추">매운 고추</span>
												<span class="topping-tag" data-id="15" data-name="새우튀김">새우튀김</span>
												<span class="topping-tag" data-id="16" data-name="두부">두부</span>
												<span class="topping-tag" data-id="17" data-name="시금치">시금치</span>
												<span class="topping-tag" data-id="18" data-name="팽이버섯">팽이버섯</span>
												<span class="topping-tag" data-id="19" data-name="고추기름">고추기름</span>
												<span class="topping-tag" data-id="20" data-name="텐카스">텐카스</span>
											</div>
											<div class="default-toppings-container"></div>
										</div>
									</div>

									<!-- 추가 토핑 입력 -->
									<!-- 추가 토핑 입력 컨테이너 -->
									<div id="extra-toppings-container" style="display: none;">
										<div class="extra-topping-item d-flex align-items-center mb-2">
											<input type="text" name="menus[0].extraToppings[0]" class="form-control form-control-sm" placeholder="추가 토핑 (예: 매운 멘마)">
											<button type="button" class="btn btn-sm btn-outline-danger ms-2" onclick="removeExtraTopping(this)">삭제</button>
										</div>
									</div>

									<button type="button" class="btn btn-sm btn-outline-secondary" style="width: 80px;" onclick="addExtraTopping(0)">+ 추가 토핑</button>


									<!-- 삭제 버튼 -->
									<div class="col-12 text-end">
										<button type="button" class="btn btn-sm btn-outline-danger remove-menu">삭제</button>
									</div>
								</div>
							</div>
						</div>
					<button type="button" id="add-menu" class="btn btn-sm btn-outline-primary mb-4">+ 메뉴 추가</button>

						<!-- 제출 버튼 -->
						<div class="text-center">
							<button type="submit" class="btn btn-success btn-lg">등록하기</button>
						</div>
					</div>
				</div>
			</div>
			</div>
		</form>

	</main>


	<footer>
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6">
					<h3 data-bs-target="#collapse_1">Quick Links</h3>
					<div class="collapse dont-collapse-sm links" id="collapse_1">
						<ul>
							<li><a href="submit-rider.html">Become a Rider</a></li>
							<li><a href="regist.html">Add your restaurant</a></li>
							<li><a href="help.html">Help</a></li>
							<li><a href="account.html">My account</a></li>
							<li><a href="blog.html">Blog</a></li>
							<li><a href="contacts.html">Contacts</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<h3 data-bs-target="#collapse_2">Categories</h3>
					<div class="collapse dont-collapse-sm links" id="collapse_2">
						<ul>
							<li><a href="grid-listing-filterscol.html">Top Categories</a></li>
							<li><a href="grid-listing-filterscol-full-masonry.html">Best Rated</a></li>
							<li><a href="grid-listing-filterscol-full-width.html">Best Price</a></li>
							<li><a href="grid-listing-filterscol-full-masonry.html">Latest Submissions</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
						<h3 data-bs-target="#collapse_3">Contacts</h3>
					<div class="collapse dont-collapse-sm contacts" id="collapse_3">
						<ul>
							<li><i class="icon_house_alt"></i>97845 Baker st. 567<br>Los Angeles - US</li>
							<li><i class="icon_mobile"></i>+94 423-23-221</li>
							<li><i class="icon_mail_alt"></i><a href="#0">info@domain.com</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
						<h3 data-bs-target="#collapse_4">Keep in touch</h3>
					<div class="collapse dont-collapse-sm" id="collapse_4">
						<div id="newsletter">
							<div id="message-newsletter"></div>
							<form method="post" action="assets/newsletter.php" name="newsletter_form" id="newsletter_form">
								<div class="form-group">
									<input type="email" name="email_newsletter" id="email_newsletter" class="form-control" placeholder="Your email">
									<button type="submit" id="submit-newsletter"><i class="arrow_carrot-right"></i></button>
								</div>
							</form>
						</div>
						<div class="follow_us">
							<h5>Follow Us</h5>
							<ul>
								<li><a href="#0"><i class="bi bi-facebook"></i></a></li>
								<li><a href="#0"><i class="bi bi-twitter-x"></i></a></li>
								<li><a href="#0"><i class="bi bi-instagram"></i></a></li>
								<li><a href="#0"><i class="bi bi-tiktok"></i></a></li>
								<li><a href="#0"><i class="bi bi-whatsapp"></i></a></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<!-- /row-->
			<hr>
			<div class="row add_bottom_25">
				<div class="col-lg-6">
					<ul class="footer-selector clearfix">
						<li>
							<div class="styled-select lang-selector">
								<select>
									<option value="English" selected>English</option>
									<option value="French">French</option>
									<option value="Spanish">Spanish</option>
									<option value="Russian">Russian</option>
								</select>
							</div>
						</li>
						<li>
							<div class="styled-select currency-selector">
								<select>
									<option value="US Dollars" selected>US Dollars</option>
									<option value="Euro">Euro</option>
								</select>
							</div>
						</li>
						<li><img src="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==" data-src="/img/cards_all.svg" alt="" width="198" height="30" class="lazy"></li>
					</ul>
				</div>
				<div class="col-lg-6">
					<ul class="additional_links">
						<li><a href="#0">Terms and conditions</a></li>
						<li><a href="#0">Privacy</a></li>
						<li><span>© Foogra</span></li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
	<!--/footer-->

	<div id="toTop"></div><!-- Back to top button -->

	<div class="layer"></div><!-- Opacity Mask Menu Mobile -->

	<!-- Sign In Modal -->
	<div id="sign-in-dialog" class="zoom-anim-dialog mfp-hide">
		<div class="modal_header">
			<h3>Sign In</h3>
		</div>
		<form>
			<div class="sign-in-wrapper">
				<a href="#0" class="social_bt facebook">Login with Facebook</a>
				<a href="#0" class="social_bt google">Login with Google</a>
				<div class="divider"><span>Or</span></div>
				<div class="form-group">
					<label>Email</label>
					<input type="email" class="form-control" name="email" id="email">
					<i class="icon_mail_alt"></i>
				</div>
				<div class="form-group">
					<label>Password</label>
					<input type="password" class="form-control" name="password" id="password" value="">
					<i class="icon_lock_alt"></i>
				</div>
				<div class="clearfix add_bottom_15">
					<div class="checkboxes float-start">
						<label class="container_check">Remember me
						  <input type="checkbox">
						  <span class="checkmark"></span>
						</label>
					</div>
					<div class="float-end"><a id="forgot" href="javascript:void(0);">Forgot Password?</a></div>
				</div>
				<div class="text-center">
					<input type="submit" value="Log In" class="btn_1 full-width mb_5">
					Don’t have an account? <a href="account.html">Sign up</a>
				</div>
				<div id="forgot_pw">
					<div class="form-group">
						<label>Please confirm login email below</label>
						<input type="email" class="form-control" name="email_forgot" id="email_forgot">
						<i class="icon_mail_alt"></i>
					</div>
					<p>You will receive an email containing a link allowing you to reset your password to a new preferred one.</p>
					<div class="text-center"><input type="submit" value="Reset Password" class="btn_1"></div>
				</div>
			</div>
		</form>
		<!--form -->
	</div>
	<!-- /Sign In Modal -->







	<!-- COMMON SCRIPTS -->
    <script src="/js/common_scripts.min.js"></script>
    <script src="/js/common_func.js"></script>
    <script src="/assets/validate.js"></script>

	<!-- ❗JS 스크립트 ❗ -->

	<!-- 카카오 다음 우편번호 API 스크립트 -->
	<script src="https://ssl.daumcdn.net/dmaps/map_js_init/postcode.v2.js" charset="utf-8"></script>

	<script>
		/* ==============================
           카카오 주소 검색
           ============================== */
		function openPostcode() {
			new daum.Postcode({
				oncomplete: function (data) {
					const roadAddress = data.roadAddress;
					const zonecode = data.zonecode;

					document.getElementById("address-api").value = roadAddress;
					document.getElementById("zipcode").value = zonecode;
					document.getElementById("store_detail_input").focus();

					fetch("/api/location-info", {
						method: "POST",
						headers: { "Content-Type": "application/json" },
						body: JSON.stringify({ roadAddress })
					})
							.then(res => res.json())
							.then(data => {
								document.getElementById("storeLegalCode").value = data.storeLegalCode || '';
								document.getElementById("storeLat").value = data.storeLat || '';
								document.getElementById("storeLng").value = data.storeLng || '';
							})
							.catch(err => console.error("주소 정보 조회 실패:", err));
				}
			}).open();
		}

		document.getElementById("searchAddressBtn").addEventListener("click", openPostcode);
		document.getElementById("address-api").addEventListener("click", openPostcode);

		/* ==============================
           전화번호 처리
           ============================== */
		const phonePrefix = document.getElementById('phonePrefix');
		const phoneRest = document.getElementById('phoneRest');
		const phoneHidden = document.getElementById('phone');

		phoneRest.addEventListener('input', e => {
			let val = e.target.value.replace(/[^0-9]/g, '');
			if (val.length > 4) val = val.slice(0, 4) + '-' + val.slice(4, 8);
			e.target.value = val;
		});

		document.getElementById('register').addEventListener('submit', e => {
			const prefix = phonePrefix.value;
			const rest = phoneRest.value.replace(/-/g, '');
			if (!prefix || !rest) {
				alert('전화번호를 올바르게 입력해주세요.');
				e.preventDefault();
				return false;
			}
			phoneHidden.value = prefix + rest;
		});

		/* ==============================
           대표 이미지 업로드 미리보기
           ============================== */
		document.getElementById('image-upload-area').addEventListener('click', () => {
			document.getElementById('image-input').click();
		});

		document.getElementById('image-input').addEventListener('change', event => {
			const file = event.target.files[0];
			const preview = document.getElementById('preview-image');
			const uploadText = document.getElementById('upload-text');
			if (file) {
				const reader = new FileReader();
				reader.onload = e => {
					preview.src = e.target.result;
					preview.style.display = 'block';
					uploadText.style.display = 'none';
				};
				reader.readAsDataURL(file);
			}
		});

		/* ==============================
           메뉴 추가/삭제 및 이미지 업로드
           ============================== */
		let menuIndex = 1;
		const menuList = document.getElementById('menu-items');
		const template = document.querySelector('.menu-item');
		const addButton = document.getElementById('add-menu');

		addButton.addEventListener('click', () => {
			const clone = template.cloneNode(true);
			clone.querySelectorAll('input, select, textarea').forEach(input => {
				if (input.name) input.name = input.name.replace(/\d+/, menuIndex);
				if (input.id) {
					const newId = input.id.replace(/\d+/, menuIndex);
					const label = clone.querySelector(`label[for="${input.id}"]`);
					input.id = newId;
					if (label) label.setAttribute("for", newId);
				}
				input.type === 'checkbox' || input.type === 'radio' ? input.checked = false : input.value = '';
			});

			clone.querySelectorAll('.topping-tags, .default-toppings-container').forEach(el => {
				el.dataset.menuIndex = menuIndex;
			});

			const preview = clone.querySelector('.menu-preview-image');
			if (preview) {
				preview.src = '';
				preview.style.display = 'none';
			}

			setupMenuImageUpload(clone);
			setupToppingTags(clone);
			updateRemoveMenuButtons(clone);

			menuList.insertBefore(clone, addButton);
			menuIndex++;
		});

		function updateRemoveMenuButtons(context = document) {
			context.querySelectorAll('.remove-menu').forEach(button => {
				button.onclick = () => {
					const allMenus = document.querySelectorAll('.menu-item');
					if (allMenus.length > 1) button.closest('.menu-item').remove();
					else alert("최소 한 개의 메뉴는 등록되어 있어야 합니다.");
				};
			});
		}

		function setupMenuImageUpload(area) {
			const uploadArea = area.querySelector('.menu-image-upload');
			const input = uploadArea.querySelector('.menu-image-input');
			const preview = uploadArea.querySelector('.menu-preview-image');
			const uploadText = uploadArea.querySelector('p');

			uploadArea.addEventListener('click', () => input.click());
			['dragover', 'dragleave'].forEach(evt => uploadArea.addEventListener(evt, e => {
				e.preventDefault();
				uploadArea.style.borderColor = evt === 'dragover' ? '#007bff' : '#ccc';
			}));
			uploadArea.addEventListener('drop', e => {
				e.preventDefault();
				uploadArea.style.borderColor = '#ccc';
				const file = e.dataTransfer.files[0];
				if (file) {
					input.files = e.dataTransfer.files;
					preview.src = URL.createObjectURL(file);
					preview.style.display = 'block';
					if (uploadText) uploadText.style.display = 'none';
				}
			});
			input.addEventListener('change', () => {
				const file = input.files[0];
				if (file) {
					preview.src = URL.createObjectURL(file);
					preview.style.display = 'block';
					if (uploadText) uploadText.style.display = 'none';
				}
			});
		}

		/* ==============================
           토핑 선택 기능
           ============================== */
		function setupToppingTags(context = document) {
			context.querySelectorAll('.topping-tag').forEach(tag => {
				tag.addEventListener('click', () => {
					tag.classList.toggle('selected');
					const container = tag.closest('.menu-item');
					const defaultContainer = container.querySelector('.default-toppings-container');
					const menuIndex = container.querySelector('.topping-tags').dataset.menuIndex;
					const toppingId = tag.dataset.id;

					const existing = defaultContainer.querySelector(`input[value="${toppingId}"]`);
					if (tag.classList.contains('selected')) {
						if (!existing) {
							const input = document.createElement('input');
							input.type = 'hidden';
							input.name = `menus[${menuIndex}].defaultToppingIds`;
							input.value = toppingId;
							defaultContainer.appendChild(input);
						}
					} else {
						if (existing) defaultContainer.removeChild(existing);
					}
				});
			});
		}

		/* ==============================
           한 줄 소개 안내문
           ============================== */
		const textarea = document.getElementById('owner-intro');
		const hint = document.getElementById('owner-intro-hint');
		function updateHintVisibility() {
			hint.style.opacity = textarea.value.trim() ? '0' : '1';
		}
		textarea.addEventListener('input', updateHintVisibility);
		window.addEventListener('DOMContentLoaded', updateHintVisibility);

		/* ==============================
           지역카드 체크 처리
           ============================== */
		document.querySelector("form").addEventListener("submit", function () {
			const regionCard = document.getElementById("regionCardCheck");
			if (!regionCard.checked) {
				const hiddenInput = document.createElement("input");
				hiddenInput.type = "hidden";
				hiddenInput.name = "isLocalCard";
				hiddenInput.value = "false";
				this.appendChild(hiddenInput);
			}
		});

		/* ==============================
           추가 토핑 추가/삭제
           ============================== */
		function addExtraTopping(menuIndex) {
			const container = document.querySelector(`#extra-toppings-container-${menuIndex}`) || document.getElementById('extra-toppings-container');
			if (container.style.display === 'none') {
				container.style.display = 'block';
				if (container.querySelectorAll('.extra-topping-item').length > 0) return;
			}

			const count = container.querySelectorAll('input').length;
			const wrapper = document.createElement('div');
			wrapper.className = 'extra-topping-item d-flex align-items-center mb-2';

			const input = document.createElement('input');
			input.type = 'text';
			input.name = `menus[${menuIndex}].extraToppings[${count}]`;
			input.className = 'form-control form-control-sm';
			input.placeholder = '추가 토핑 (예: 매운 멘마)';

			const btn = document.createElement('button');
			btn.type = 'button';
			btn.className = 'btn btn-sm btn-outline-danger ms-2';
			btn.textContent = '삭제';
			btn.onclick = () => container.removeChild(wrapper);

			wrapper.appendChild(input);
			wrapper.appendChild(btn);
			container.appendChild(wrapper);
		}

		/* ==============================
           최초 템플릿 초기화 1회만 수행
           ============================== */
		setupMenuImageUpload(template);
		setupToppingTags(template);
		updateRemoveMenuButtons(template);

		/* ==============================
		요일별 영업시간
		============================== */

		const days = ["MONDAY", "TUESDAY", "WEDNESDAY", "THURSDAY", "FRIDAY", "SATURDAY", "SUNDAY"];
		const dayLabels = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];

		function generateTimeOptions() {
			const options = [];
			for (let h = 0; h < 24; h++) {
				const hour = h % 12 === 0 ? 12 : h % 12;
				const meridian = h < 12 ? "AM" : "PM";
				const value = `${h.toString().padStart(2, '0')}:00`;
				const label = `${hour} ${meridian}`;
				options.push(`<option value="${value}">${label}</option>`);
			}
			return options.join("");
		}

		function checkClosed(index) {
			const open = document.querySelector(`[name="weekSchedule[${index}].openingAt"]`);
			const close = document.querySelector(`[name="weekSchedule[${index}].closingAt"]`);
			const closedInput = document.getElementById(`closed-day-${index}`);

			if (open) open.scrollIntoView({ behavior: 'smooth', block: 'center' });

			if (open.value === "CLOSED" || close.value === "CLOSED") {
				closedInput.value = "true";
				open.disabled = true;
				close.disabled = true;
			} else {
				closedInput.value = "false";
				open.disabled = false;
				close.disabled = false;
			}
		}

		function renderOpeningSchedule() {
			const container = document.getElementById("opening-schedule");
			let html = "";
			for (let i = 0; i < days.length; i++) {
				html += `
      <div class="row mb-2 align-items-center">
        <div class="col-md-2">
          <label class="fix_spacing">${dayLabels[i]}</label>
          <input type="hidden" name="weekSchedule[${i}].dayOfWeek" value="${days[i]}">
          <input type="hidden" name="weekSchedule[${i}].isClosedDay" value="false" id="closed-day-${i}">
        </div>
        <div class="col-md-5">
          <div class="form-group">
            <select class="form-control" name="weekSchedule[${i}].openingAt" onchange="checkClosed(${i})">
              <option value="">Opening Time</option>
              <option value="CLOSED">Closed</option>
              ${generateTimeOptions()}
            </select>
          </div>
        </div>
        <div class="col-md-5">
          <div class="form-group">
            <select class="form-control" name="weekSchedule[${i}].closingAt" onchange="checkClosed(${i})">
              <option value="">Closing Time</option>
              <option value="CLOSED">Closed</option>
              ${generateTimeOptions()}
            </select>
          </div>
        </div>
      </div>
    `;
			}
			container.innerHTML = html;
		}

		document.addEventListener("DOMContentLoaded", renderOpeningSchedule);
	</script>

</body>
</html>